<p>-- ORDINI --</p>

<div class="container" *ngIf="role === 0 || role === 1">
    <mat-accordion *ngIf="myOrders.length > 0">
        <div *ngIf="arrivedOrders.length > 0">
            <p>Ordini arrivati</p>
            <mat-expansion-panel *ngFor="let order of arrivedOrders" hideToggle>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Tavoli: &nbsp;<span *ngFor="let table of order.tables">{{table.number}} &nbsp;</span>
                    </mat-panel-title>
                    <mat-panel-description>
                        <span> Tempo di preparazione: {{order.total_queue_time}}'</span>
                    </mat-panel-description>
                </mat-expansion-panel-header>
    
                <ul *ngIf="order.foods_ordered.length > 0"> 
                    Stato pietanze: 
                    <span *ngIf="order.status.foods === 0"> Ricevute </span>
                    <span *ngIf="order.status.foods === 1"> In preparazione </span>
                    <li *ngFor="let food of order.foods_ordered">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>
    
                <mat-divider *ngIf="order.beverages_ordered.length > 0"></mat-divider>
    
                <ul *ngIf="order.beverages_ordered.length > 0"> 
                    Stato bevande: 
                    <span *ngIf="order.status.beverages === 0"> Ricevute </span>
                    <span *ngIf="order.status.beverages === 1"> In preparazione </span>
                    <li *ngFor="let food of order.beverages_ordered">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>
            </mat-expansion-panel>
        </div>

        <br>

        <div *ngIf="preparingOrders.length > 0">
            <p>Ordini in preparazione</p>
            <mat-expansion-panel *ngFor="let order of preparingOrders" hideToggle>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Tavoli: &nbsp;<span *ngFor="let table of order.tables">{{table.number}} &nbsp;</span>
                    </mat-panel-title>
                    <mat-panel-description>
                        <span> Tempo di preparazione: {{order.total_queue_time}}'</span>
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <ul *ngIf="order.foods_ordered.length > 0"> 
                    Stato pietanze: 
                    <span *ngIf="order.status.foods === 0"> Ricevute </span>
                    <span *ngIf="order.status.foods === 1"> In preparazione </span>
                    <li *ngFor="let food of order.foods_ordered">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>

                <mat-divider *ngIf="order.beverages_ordered.length > 0"></mat-divider>

                <ul *ngIf="order.beverages_ordered.length > 0"> 
                    Stato bevande: 
                    <span *ngIf="order.status.beverages === 0"> Ricevute </span>
                    <span *ngIf="order.status.beverages === 1"> In preparazione </span>
                    <li *ngFor="let food of order.beverages_ordered">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>
            </mat-expansion-panel>
        </div>
        
        <br>

        <div *ngIf="terminatedOrders.length > 0">
            <p>Ordini terminati</p>
            <mat-expansion-panel *ngFor="let order of terminatedOrders" hideToggle>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Tavoli: &nbsp;<span *ngFor="let table of order.tables">{{table.number}} &nbsp;</span>
                    </mat-panel-title>
                    <mat-panel-description>
                        <span> Tempo di preparazione: {{order.total_queue_time}}'</span>
                    </mat-panel-description>
                </mat-expansion-panel-header>
    
                <ul *ngIf="order.foods_prepared.length > 0"> Cibi:
                    <li *ngFor="let food of order.foods_prepared">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>
    
                <mat-divider *ngIf="order.beverages_prepared.length > 0"></mat-divider>
    
                <ul *ngIf="order.beverages_prepared.length > 0"> Bevande:
                    <li *ngFor="let food of order.beverages_prepared">
                        {{food.name}} ({{food.prepareTime}}')
                    </li>
                </ul>
    
                <button mat-raised-button (click)="pay(order)">Procedi al pagamento</button>
            </mat-expansion-panel>
        </div>
        
    </mat-accordion>
</div>

<div class="container" *ngIf="role === 2 || role === 3">
    <mat-accordion *ngIf="arrivedOrders.length > 0">
        <p>Ordini arrivati</p>
        <mat-expansion-panel *ngFor="let order of arrivedOrders" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Tavoli: &nbsp;<span *ngFor="let table of order.tables">{{table.number}} &nbsp;</span>
                </mat-panel-title>
                <mat-panel-description>
                    <span> Tempo di preparazione: {{order.total_queue_time}}'</span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <p *ngFor="let food of ((role === 3) ? order.foods_ordered : order.beverages_ordered)">
                {{food.name}} ({{food.prepareTime}}')
            </p>
            <button mat-raised-button (click)="updateOrder(order)"> Prendi in carico </button>
        </mat-expansion-panel>
    </mat-accordion>

    <mat-accordion *ngIf="preparingOrders.length > 0">
        <p>Ordini in preparazione</p>
        <mat-expansion-panel *ngFor="let order of preparingOrders" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Tavoli: &nbsp;<span *ngFor="let table of order.tables">{{table.number}} &nbsp;</span>
                </mat-panel-title>
                <mat-panel-description>
                    <span> Tempo di preparazione: {{order.total_queue_time}}'</span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <p *ngFor="let food of ((role === 3) ? order.foods_ordered : order.beverages_ordered)">
                {{food.name}} ({{food.prepareTime}}')
            </p>
            <button mat-raised-button (click)="updateOrder(order)"> Termina </button>
        </mat-expansion-panel>
    </mat-accordion>
</div>

<div class="container" *ngIf="role === 4">
    <p>Tavoli selezionati: {{shownSelectedTables}}</p>

    <ul *ngIf="shownOrders.length > 0" > Tavoli che hanno gi√† ordinato
        <br>
        <br>
        <ng-container *ngFor="let order of shownOrders">
            <li *ngFor="let table of order.tables">
                <button mat-raised-button (click)="selectTable(table, order)"> tavolo: {{table.number}} </button>
                <br>
                <br>
            </li>
        </ng-container>
    </ul>

    <ul *ngIf="tablesWithoutOrders.length > 0"> Tavoli che devono ancora ordinare
        <br>
        <br>
        <li *ngFor="let table of tablesWithoutOrders">
            <button mat-raised-button (click)="selectTable(table, null)">
                tavolo: {{table.number}}
            </button>
            <br>
            <br>
        </li>
    </ul>

    <mat-divider></mat-divider>
    <br>

    <button mat-raised-button (click)="getOrderId()"> Avanti </button>
</div>

<br>

<a routerLink="/home"><button mat-raised-button> Home </button></a>